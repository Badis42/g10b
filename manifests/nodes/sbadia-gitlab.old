node gitlab {
	include g10b-node

	$gitlab_dbname = 'gitlab'
	$gitlab_dbuser = 'gitlab'
	$gitlab_dbpwd  = $mysql_password

	# Needed extra packages for the sbadia-gitlab module
	class { '::mysql::server':
    	root_password  =>  $mysql_password,
    	databases => { "$gitlab_dbname" => { ensure => 'present' } }
  	} ->
  	package { 'build-essential':
		name => 'build-essential',
		ensure => installed,
		} ->
	package { 'g++':
		name => 'g++',
		ensure => installed,
	} ->
	package { 'ruby1.9.3':
		name => 'ruby1.9.3',
		ensure => installed,
	} ->
	package { 'ruby-dev':
		name => 'ruby-dev',
		ensure => installed,
	} ->
	class { 'gitlab':
		git_user          => 'gitlab',
	    git_email         => 'notifs@foobar.fr',
	    git_comment       => 'GitLab',
	    gitlab_domain     => 'gitlab.oloc',
	    gitlab_dbtype     => 'mysql',
	    gitlab_dbname     => $gitlab_dbname,
	    gitlab_dbuser     => $gitlab_dbuser,
	    gitlab_dbpwd      => $gitlab_dbpwd,
	    ldap_enabled      => false,
	}

}
